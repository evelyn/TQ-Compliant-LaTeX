\documentclass[12pt]{article}

% -------- # Packages
% Document layout and formatting
\usepackage[letterpaper, portrait, margin=1in, top=1.75in, bottom=1in, headheight=1in, heightrounded]{geometry}
\usepackage{fancyhdr, afterpage, etoolbox} 

% Fonts and text formatting
\usepackage[T1]{fontenc}
\usepackage{inconsolata, mathptmx}
\usepackage{xcolor, ragged2e, parskip}

% Math and calculations
\usepackage{amsmath, amsfonts, amssymb, amsthm, calc, pgffor}

% Date formatting and utilities
\usepackage{datetime, lipsum}

% Graphics and lists
\usepackage{graphicx, enumitem}

% For table layout with wrapping and raggedright alignment
\usepackage{tabularx}

% -------- # Layout Adjustment
\newlength\newtop
\setlength{\newtop}{0.75in} % Set a custom top margin offset (0.75 inches)
\setlength{\parskip}{12pt} % Double spacing between paragraphs
\setlength{\parindent}{0pt} % No indentation for new paragraphs

\makeatletter
\patchcmd\@outputpage{\global \@colht \textheight}{%
    \global\textheight=\dimexpr\textheight+\newtop\relax%
    \global\topmargin=\dimexpr\topmargin-\newtop\relax%
    \global\@colht\textheight%
    \global\newtop\z@}{}{\err} % Reset \newtop after adjustment
\makeatother

% -------- # Custom Settings & Commands
% Define a single non-breaking space (~) as a base unit length
\newlength{\baseSpaceLength}
\settowidth{\baseSpaceLength}{~} % Set the base space length to the width of a single non-breaking space
\newcommand{\spaceLength}[1]{\dimexpr #1\baseSpaceLength\relax} % Define a command that multiplies the length of ~ by a factor
\newcommand{\indentLevel}[2]{\dimexpr #2\baseSpaceLength * #1\relax} % Define a command that multiplies the length of ~ by two factors

% Define a macro to calculate the column width dynamically with added space
\newcommand{\setcolumnwidth}[2]{
    \newlength{#1}%
    \settowidth{#1}{#2}%
    \addtolength{#1}{\spaceLength{2}} % Add extra space to the column width
}

% Define DTG date format
\newdateformat{DTG}{%
  \twodigit{\THEDAY}~\monthname[\THEMONTH]~\THEYEAR} % Format: DD Month YYYY

% Define a custom color for the letterhead (DAF branding)
\definecolor{headercolor}{HTML}{121292}

% Create a command for styled letterhead with the custom color
\newcommand{\letterhead}[1]{\textcolor{headercolor}{\textsc{#1}}}

% Create a command to apply list formatting settings for a specific level
\newcommand{\formatListLevel}[4]{
  \setlist[enumerate,#1]{
    label=#2, % The label format for the current list level
    itemindent=\dimexpr \indentLevel{#1}{#3}\relax, % Controls the left of the margin and the left of the item
                                                    % The first argument adjusts the overall indentation level (e.g., nesting level)
                                                    % The second argument sets the scaling factor for the indentation distance
    left=\spaceLength{0}, % Horizontal movement for everything
    labelsep=\dimexpr \spaceLength{#4}\relax, % \spaceLength{N} = ~ in label, can be kept as 0 if using ~~
                                              % label + Distance between content
    leftmargin=\spaceLength{0} % Align everything flush with the left margin
  }
}

% -------- # Header & Footer
\setlength{\footskip}{0.5in}

\fancyfoot[C]{
    \fontsize{8}{10}\selectfont
    \texttt{CONTROLLED UNCLASSIFIED INFORMATION (CUI) which must be protected under the Freedom of Information Act (5 U.S.C. 552) and/or the Privacy Act of 1974 (5 U.S.C. 552a). Unauthorized disclosure or misuse of this PERSONAL INFORMATION may result in disciplinary action, criminal and/or civil penalties.}
}

\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

\fancypagestyle{default}{\fancyhead{}}

\fancypagestyle{firstpage}{
    \fancyhead[L]{\hspace*{-0.5in}\vspace*{-0.25in}\includegraphics[width=1in]{"DAF Seal.png"}} % Air Force seal aligned to left
    \fancyhead[C]{
        \letterhead{\textbf{DEPARTMENT OF THE AIR FORCE}}\\
        \letterhead{123d EXAMPLE MEMORANDUM SQUADRON (ACC)}\\
        \letterhead{FORT GEORGE G. MEADE, MARYLAND}
    }
}

% -------- # List settings
\formatListLevel{1}{\arabic*.}{4}{2}
\formatListLevel{2}{\alph*.}{4}{2}
\formatListLevel{3}{(\alph*)}{4}{2}
\formatListLevel{4}{\roman*.}{4}{2}
\formatListLevel{5}{(\Alph*)}{4}{2}
\formatListLevel{6}{(\Roman*)}{4}{2}

% -------- # Page details
\begin{document}
\pagestyle{default}
\thispagestyle{firstpage}
\RaggedRight

% DTG aligned to the right (AF memorandum standards)
\noindent\hfill\DTG\today

% MEMORANDUM FOR section
\setcolumnwidth{\memoWidth}{MEMORANDUM FOR}
\noindent
\begin{tabularx}{\textwidth}{@{} p{\memoWidth} @{} >{\RaggedRight}X @{}}
MEMORANDUM FOR & SSGT ADELINE V. WOOLF (9012345678)\\
               & SRA CHARLOTTE H. BRONTÃ‹ (7890123456)\\
\end{tabularx}

% FROM: section
\setcolumnwidth{\fromWidth}{FROM:}
\noindent
\begin{tabularx}{\textwidth}{@{} p{\fromWidth} @{} >{\RaggedRight}X @{}}
FROM: & TSGT JANE S. AUSTEN (1234567890)\\
      & 123d Example Memorandum Squadron\\
      & 4567 Writing Street\\
      & Fort George G. Meade, MD 20755\\
\end{tabularx}

% SUBJECT: section
\setcolumnwidth{\subjectWidth}{SUBJECT:}
\noindent
\begin{tabularx}{\textwidth}{@{} p{\subjectWidth} @{} >{\RaggedRight}X @{}}
SUBJECT: & Use of the Official Memorandum Template\\
\end{tabularx}

% REFERENCES section
\setcolumnwidth{\referencesWidth}{References:}
\noindent
\begin{tabularx}{\textwidth}{@{} p{\referencesWidth} @{} >{\RaggedRight}X @{}}
References: & (a)~AFM 70-420, 20 April 2011, \textit{Preparing Official Communications}.\\
            & (b)~DoDM 1235.77-M-V8, 09 November, 2010, \textit{DoD Manual for Writing Manuals on Writing Manuals}.\\
            & (c)~DAFI 42-1245, September 18, 2024, \textit{Pretending You're a Famous Dead Author and Your Troop is Another Dead Author}.\\
\end{tabularx}

% Main content placeholder
\begin{enumerate}
    \item \lipsum[1] % First level (wraps to margin)
    
    \begin{enumerate}
        \item \lipsum[1] % Second level (indented first line, wraps to margin)

        \item \lipsum[1]
        
        \begin{enumerate}
            \item \lipsum[1] % Third level (indented first line, wraps to margin)
        \end{enumerate}

    \end{enumerate}
    
    \item \lipsum[1] % First level (wraps to margin)
    
\end{enumerate}

% -------- # End Document
\end{document}
